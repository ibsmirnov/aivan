(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7688:(e,t,a)=>{Promise.resolve().then(a.bind(a,3390))},3390:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var l=a(5155),s=a(2115),r=a(1471);function n(e){let{minLevel:t,maxLevel:a,currentLevel:s,availableLevels:r,onChange:n}=e;return(0,l.jsxs)("div",{className:"relative w-full",children:[(0,l.jsx)("input",{type:"range",min:t,max:a,value:s,onChange:e=>n(Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,l.jsx)("div",{className:"absolute w-full flex justify-between px-1",style:{top:"-12px"},children:r.map(e=>(0,l.jsx)("div",{className:"w-px h-3 bg-gray-400"},e))})]})}function c(e){let{titles:t,selectedPoints:a,selectedClusterId:s}=e;return a&&0!==a.length?(0,l.jsx)("div",{className:"space-y-3",children:a.map(e=>(0,l.jsx)("div",{className:"text-sm text-black",children:t[e]},"".concat(s,"-").concat(e)))}):null}function i(){let e=(0,s.useRef)(null),[t,a]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(0),[p,x]=(0,s.useState)(0),[m,v]=(0,s.useState)(0),[g,b]=(0,s.useState)([]),[j,y]=(0,s.useState)(null),[w,N]=(0,s.useState)(null),[k,S]=(0,s.useState)(new Set),[L,C]=(0,s.useState)(""),E=e=>{if(0===e)return"rgb(255, 255, 255)";let t=Math.abs(e);return e<0?"rgba(79, 70, 229, ".concat(t,")"):"rgba(239, 68, 68, ".concat(t,")")};return(0,s.useEffect)(()=>{if(!t||!L.trim()){S(new Set);return}let e=L.toLowerCase(),a=new Set;Object.entries(t.clusters).forEach(l=>{let[s,r]=l;(r.points||[]).some(a=>t.titles[a].toLowerCase().includes(e))&&a.add(Number(s))}),S(a)},[L,t]),(0,s.useEffect)(()=>{fetch("/data.json").then(e=>e.json()).then(e=>{let t=Object.values(e.clusters).map(e=>e.level),l=Array.from(new Set(t)).sort((e,t)=>e-t),s=Math.min(...t),r=Math.max(...t);f(s),x(r),v(s),b(l),a(e)})},[]),(0,s.useEffect)(()=>{var a;if(!t||!e.current)return;let l=null===(a=Object.values(t.clusters).find(e=>-1===e.parent))||void 0===a?void 0:a.id;if(!l)return;let s=function e(a){let l=t.clusters[a];return{...l,children:l.children.map(t=>e(t))}}(l),n=e.current.clientWidth,c=e.current.clientHeight,i={top:40,right:30,bottom:30,left:30},h=n-i.left-i.right,f=c-i.top-i.bottom,p=r.B22().size([h,f])(r.Sk5(s)),x=r.Ltv(e.current).selectAll("g.container").data([null]).join("g").attr("class","container").attr("transform","translate(".concat(i.left,",").concat(i.top,")")),v=x.selectAll(".link").data(p.links()).join("path").attr("class","link").attr("fill","none").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",1).attr("d",r.vu().x(e=>e.x).y(e=>e.y)),g=x.selectAll(".node").data(p.descendants()).join("g").attr("class","node").attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")")).style("cursor","pointer").on("click",(e,t)=>{t.data.level>=m&&(o(t.data.points||[]),u(t.data.id))});g.each(function(){let e=r.Ltv(this);e.select(".node-bg").size()||e.append("circle").attr("r",6).attr("fill","white").attr("stroke","none").attr("class","node-bg"),e.select(".search-indicator").size()||e.append("circle").attr("r",3).attr("class","search-indicator"),e.select(".node-circle").size()||e.append("circle").attr("r",6).attr("class","node-circle")}),g.select(".search-indicator").attr("fill",e=>k.has(e.data.id)?"#000000":"transparent").attr("opacity",1),g.select(".node-circle").attr("fill",e=>E(e.data.binary_proportion_normalized)).attr("stroke",e=>e.data.id===d?"#000000":"#666").attr("stroke-width",e=>e.data.id===d?2:1),y(g),N(v)},[t,k,d,m]),(0,s.useEffect)(()=>{j&&w&&(j.each(function(e){let t=r.Ltv(this),a=e.data.level>=m;t.select(".node-circle").attr("stroke",e.data.id===d?"#000000":"#666").attr("stroke-width",e.data.id===d?2:1),t.style("opacity",a?1:0),t.style("pointer-events",a?"all":"none")}),w.each(function(e){let t=r.Ltv(this),a=e.source.data.level>=m,l=e.target.data.level>=m;t.style("opacity",a&&l?1:0)}))},[m,j,w,d]),(0,l.jsxs)("div",{className:"flex w-full h-full",children:[(0,l.jsx)("div",{className:"flex-1 p-8 bg-white",children:(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex w-full max-w-3xl items-center gap-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(n,{minLevel:h,maxLevel:p,currentLevel:m,availableLevels:g,onChange:v})}),(0,l.jsx)("input",{type:"text",placeholder:"Search titles...",value:L,onChange:e=>C(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black placeholder:text-gray-400"})]}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("svg",{ref:e,className:"w-full h-full bg-white",style:{minHeight:"600px"}})})]})}),(0,l.jsxs)("div",{className:"w-80 h-screen overflow-y-auto border-l border-gray-200 bg-white",children:[(0,l.jsx)("div",{className:"sticky top-0 bg-white z-10 p-4 border-b border-gray-200",children:(0,l.jsx)("h2",{className:"text-lg font-medium text-black",children:null!==d&&i?"Cluster ".concat(d," (").concat(i.length," items)"):"Select a cluster"})}),(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(c,{titles:(null==t?void 0:t.titles)||[],selectedPoints:i,selectedClusterId:d})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[471,441,517,358],()=>t(7688)),_N_E=e.O()}]);