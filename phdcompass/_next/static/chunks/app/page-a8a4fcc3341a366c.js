(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7688:(e,t,l)=>{Promise.resolve().then(l.bind(l,3390))},3390:(e,t,l)=>{"use strict";l.d(t,{default:()=>c});var a=l(5155),s=l(2115),r=l(7431);function n(e){let{minLevel:t,maxLevel:l,currentLevel:s,availableLevels:r,onChange:n}=e;return(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{type:"range",min:t,max:l,value:s,onChange:e=>n(Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,a.jsx)("div",{className:"absolute w-full flex justify-between px-1",style:{top:"-12px"},children:r.map(e=>(0,a.jsx)("div",{className:"w-px h-3 bg-gray-400"},e))})]})}function i(e){let{titles:t,selectedPoints:l,selectedClusterId:s,clusterSummary:r}=e;return l&&0!==l.length?(0,a.jsxs)("div",{className:"space-y-4",children:[r&&(0,a.jsx)("div",{className:"bg-gray-50 p-3 rounded-md",children:(0,a.jsx)("p",{className:"text-sm text-black",children:r})}),(0,a.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,a.jsx)("div",{className:"text-sm text-[#333333]",children:t[e]},"".concat(s,"-").concat(e)))})]}):null}function c(){let e=(0,s.useRef)(null),[t,l]=(0,s.useState)(null),[c,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[p,h]=(0,s.useState)(void 0),[m,x]=(0,s.useState)(0),[f,v]=(0,s.useState)(0),[y,b]=(0,s.useState)(0),[g,j]=(0,s.useState)([]),[w,N]=(0,s.useState)(null),[k,S]=(0,s.useState)(null),[L,_]=(0,s.useState)(new Set),[z,C]=(0,s.useState)(""),[E,M]=(0,s.useState)(0),[O,A]=(0,s.useState)(0),W=e=>{let t;return 0===e?"rgb(255, 255, 255)":e<0?(t=Math.abs(e/O),"rgba(79, 70, 229, ".concat(t,")")):(t=e/E,"rgba(239, 68, 68, ".concat(t,")"))};return(0,s.useEffect)(()=>{if(!t||!z.trim()){_(new Set);return}let e=z.toLowerCase(),l=new Set;Object.entries(t.clusters).forEach(a=>{let[s,r]=a;(r.points||[]).some(l=>t.titles[l].toLowerCase().includes(e))&&l.add(Number(s))}),_(l)},[z,t]),(0,s.useEffect)(()=>{fetch("/phdcompass/data.json").then(e=>e.json()).then(e=>{let t=Object.values(e.clusters).map(e=>e.level),a=Array.from(new Set(t)).sort((e,t)=>e-t),s=Math.min(...t),r=Math.max(...t);x(s),v(r),b(s),j(a);let n=Object.values(e.clusters).map(e=>e.binary_proportion_normalized),i=n.filter(e=>e>0),c=n.filter(e=>e<0);M(i.length>0?Math.max(...i):1),A(c.length>0?Math.min(...c):-1),l(e)})},[]),(0,s.useEffect)(()=>{let e=r.Ltv("body").selectAll(".node-tooltip").data([null]).join("div").attr("class","node-tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("color","black").style("padding","8px").style("border","1px solid #ddd").style("border-radius","4px").style("box-shadow","0 2px 4px rgba(0,0,0,0.1)").style("max-width","300px").style("font-size","14px").style("pointer-events","none").style("z-index","1000");return()=>{e.remove()}},[]),(0,s.useEffect)(()=>{var l;if(!t||!e.current)return;let a=null===(l=Object.values(t.clusters).find(e=>-1===e.parent))||void 0===l?void 0:l.id;if(!a)return;let s=function e(l){let a=t.clusters[l];return{...a,children:a.children.map(t=>e(t))}}(a),n=e.current.clientWidth,i=e.current.clientHeight,c={top:40,right:30,bottom:30,left:30},p=n-c.left-c.right,m=i-c.top-c.bottom,x=r.B22().size([p,m])(r.Sk5(s)),f=r.Ltv(e.current).selectAll("g.container").data([null]).join("g").attr("class","container").attr("transform","translate(".concat(c.left,",").concat(c.top,")")),v=f.selectAll(".link").data(x.links()).join("path").attr("class","link").attr("fill","none").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",1).attr("d",r.vu().x(e=>e.x).y(e=>e.y)),b=f.selectAll(".node").data(x.descendants()).join("g").attr("class","node").attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")")).style("cursor","pointer").on("click",(e,t)=>{t.data.level>=y&&(o(t.data.points||[]),u(t.data.id),h(t.data.summary))}).on("mouseover",(e,t)=>{let l=r.Ltv(".node-tooltip");l.style("visibility","visible").html(t.data.summary||"No summary available");let[a,s]=r.WnM(e,document.body);l.style("left","".concat(a+15,"px")).style("top","".concat(s-10,"px"))}).on("mousemove",e=>{let t=r.Ltv(".node-tooltip"),[l,a]=r.WnM(e,document.body);t.style("left","".concat(l+15,"px")).style("top","".concat(a-10,"px"))}).on("mouseout",()=>{r.Ltv(".node-tooltip").style("visibility","hidden")});b.each(function(){let e=r.Ltv(this);e.select(".node-bg").size()||e.append("circle").attr("r",6).attr("fill","white").attr("stroke","none").attr("class","node-bg"),e.select(".search-indicator").size()||e.append("circle").attr("r",3).attr("class","search-indicator"),e.select(".node-circle").size()||e.append("circle").attr("r",6).attr("class","node-circle")}),b.select(".search-indicator").attr("fill",e=>L.has(e.data.id)?"#000000":"transparent").attr("opacity",1),b.select(".node-circle").attr("fill",e=>W(e.data.binary_proportion_normalized)).attr("stroke",e=>e.data.id===d?"#000000":"#666").attr("stroke-width",e=>e.data.id===d?2:1),N(b),S(v)},[t,L,d,y]),(0,s.useEffect)(()=>{w&&k&&(w.each(function(e){let t=r.Ltv(this),l=e.data.level>=y;t.select(".node-circle").attr("stroke",e.data.id===d?"#000000":"#666").attr("stroke-width",e.data.id===d?2:1),t.style("opacity",l?1:0),t.style("pointer-events",l?"all":"none")}),k.each(function(e){let t=r.Ltv(this),l=e.source.data.level>=y,a=e.target.data.level>=y;t.style("opacity",l&&a?1:0)}))},[y,w,k,d]),(0,a.jsxs)("div",{className:"flex w-full h-full",children:[(0,a.jsx)("div",{className:"flex-1 p-8 bg-white",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex w-full max-w-3xl items-center gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(n,{minLevel:m,maxLevel:f,currentLevel:y,availableLevels:g,onChange:b})}),(0,a.jsx)("input",{type:"text",placeholder:"Search titles...",value:z,onChange:e=>C(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black placeholder:text-gray-400"})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("svg",{ref:e,className:"w-full h-full bg-white",style:{minHeight:"600px"}})})]})}),(0,a.jsxs)("div",{className:"w-80 h-screen overflow-y-auto border-l border-gray-200 bg-white",children:[(0,a.jsx)("div",{className:"sticky top-0 bg-white z-10 p-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-black",children:null!==d&&c?"Cluster ".concat(d," (").concat(c.length," items)"):"Select a cluster"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(i,{titles:(null==t?void 0:t.titles)||[],selectedPoints:c,selectedClusterId:d,clusterSummary:p})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[431,441,517,358],()=>t(7688)),_N_E=e.O()}]);